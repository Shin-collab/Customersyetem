<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KYC | GSB Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --pk: #eb008b; --bg: #f8fafc; --cd: #ffffff; --tx: #1e293b; --bd: #e2e8f0; --in: #ffffff; }
        [data-theme="dark"] { --bg: #0f172a; --cd: #1e293b; --tx: #f8fafc; --bd: #334155; --in: #0f172a; }
        
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Sarabun', sans-serif; transition: 0.2s; }
        body { background: var(--bg); color: var(--tx); padding: 30px 15px; line-height: 1.6; }
        
        .card { background: var(--cd); max-width: 650px; margin: auto; border-radius: 20px; box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1); padding: 35px; }
        .h-title { font-size: 1.6rem; font-weight: 800; color: var(--pk); text-align: center; margin-bottom: 30px; letter-spacing: 1px; }
        
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
        .full { grid-column: span 2; }
        
        /* ปรับแต่งสำหรับมือถือ */
        @media (max-width: 600px) {
            body { padding: 15px 10px; }
            .card { padding: 20px; }
            .grid { grid-template-columns: 1fr; gap: 15px; } /* เปลี่ยนเป็นคอลัมน์เดียว */
            .full { grid-column: span 1; }
            input, select, .btn { height: 50px; font-size: 1rem !important; } /* ขยายให้กดง่าย */
            .btn-r { flex-direction: column; } /* ปุ่มกดยกเลิก/บันทึก จะเรียงลงมาข้างล่าง */
        }
        
        label { font-weight: 600; font-size: 0.9rem; display: block; margin-bottom: 8px; color: var(--tx); opacity: 0.9; }
        input, select { 
            width: 100%; padding: 12px 15px; border: 2px solid var(--bd); border-radius: 12px; 
            background: var(--in); color: var(--tx); outline: none; font-size: 0.95rem;
        }
        input:focus { border-color: var(--pk); background: var(--cd); box-shadow: 0 0 0 4px rgba(235, 0, 139, 0.1); }
        
        #eduBox { 
            display: none; background: rgba(235,0,139,0.03); padding: 20px; border-radius: 15px; 
            border: 2px dashed var(--pk); grid-column: span 2; margin: 5px 0 15px 0;
        }
        
        /* แก้ไข eduBox ให้เป็นแถวเดียวในมือถือด้วย */
        @media (max-width: 600px) {
            #eduBox { grid-column: span 1; padding: 15px; }
        }

        .btn-r { display: flex; gap: 12px; margin-top: 25px; }
        .btn { flex: 1; padding: 14px; border-radius: 12px; font-weight: 700; border: none; cursor: pointer; text-align: center; text-decoration: none; font-size: 1rem; display: flex; align-items: center; justify-content: center; gap: 8px; }
        .sv { background: var(--pk); color: #fff; box-shadow: 0 4px 14px rgba(235, 0, 139, 0.4); }
        .cc { background: var(--bd); color: var(--tx); }
        .btn:hover { transform: translateY(-2px); opacity: 0.9; }
        
        .tgl { position: fixed; top: 15px; right: 15px; cursor: pointer; color: var(--pk); font-size: 1.5rem; z-index: 100; background: var(--cd); width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; border-radius: 50%; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
    </style>
</head>
<body>

<div class="tgl" onclick="setT()"><i class="fa-solid fa-circle-half-stroke"></i></div>

<div class="card">
    <div class="h-title">บันทึกข้อมูลลูกค้า (KYC)</div>
    
    <form th:action="@{/customers/save}" th:object="${customer}" method="post" onsubmit="return val()">
        <input type="hidden" th:field="*{id}">
        
        <div class="grid">
            <div class="full">
                <label>ชื่อ-นามสกุล</label>
                <input type="text" th:field="*{name}" required id="nm" placeholder="ระบุชื่อและนามสกุล" oninput="this.value=this.value.replace(/[0-9]/g,'')">
            </div>
            
            <div><label>ชื่อเล่น</label><input type="text" th:field="*{nickname}" placeholder="ระบุชื่อเล่น"></div>
            <div><label>วันเดือนปีเกิด</label><input type="date" th:field="*{birthDate}" required></div>
            
            <div class="full"><label>ที่อยู่ปัจจุบัน</label><input type="text" th:field="*{houseNo}" placeholder="เลขที่บ้าน, หมู่บ้าน/อาคาร, ถนน"></div>
            
            <div><label>จังหวัด</label><input type="text" th:field="*{province}" placeholder="เช่น กรุงเทพฯ"></div>
            <div>
                <label>อาชีพ</label>
                <select th:field="*{occupation}" id="occ" onchange="upd()">
                    <option value="พนักงานบริษัท">พนักงานบริษัท</option>
                    <option value="ธุรกิจส่วนตัว">ธุรกิจส่วนตัว/ค้าขาย</option>
                    <option value="ข้าราชการ">ข้าราชการ/รัฐวิสาหกิจ</option>
                    <option value="กำลังศึกษา">นักเรียน/นักศึกษา</option>
                    <option value="รับจ้างทั่วไป">รับจ้างทั่วไป</option>
                    <option value="อื่นๆ">อื่นๆ</option>
                </select>
            </div>
            
            <div id="eduBox">
                <div class="grid" style="padding:0; margin:0; gap:15px;">
                    <div>
                        <label>ระดับการศึกษา</label>
                        <select th:field="*{education}">
                            <option value="อนุบาล">อนุบาล</option>
                            <option value="ประถมศึกษา">ประถมศึกษา</option>
                            <option value="มัธยมศึกษาตอนต้น">มัธยมศึกษาตอนต้น</option>
                            <option value="มัธยมศึกษาตอนปลาย">มัธยมศึกษาตอนปลาย</option>
                            <option value="ปวช.">ปวช.</option>
                            <option value="ปวส.">ปวส.</option>
                            <option value="อนุปริญญา">อนุปริญญา</option>
                            <option value="ปริญญาตรี">ปริญญาตรี</option>
                            <option value="ปริญญาโท">ปริญญาโท</option>
                            <option value="ปริญญาเอก">ปริญญาเอก</option>
                        </select>
                    </div>
                    <div>
                        <label>ชั้นปี/ระดับ</label>
                        <input type="text" th:field="*{educationYear}" placeholder="เช่น ปี 2 หรือ ม.5">
                    </div>
                    <div class="full"><label>คณะ / สาขาวิชา</label><input type="text" th:field="*{major}" placeholder="ระบุคณะหรือสายการเรียน"></div>
                </div>
            </div>
            
            <div class="full"><label>สถานที่ทำงาน / สถาบันการศึกษา</label><input type="text" th:field="*{workPlace}" placeholder="ชื่อบริษัทหรือชื่อโรงเรียน/มหาวิทยาลัย"></div>
            
            <div><label>โรคประจำตัว</label><input type="text" th:field="*{disease}" placeholder="ไม่มีให้เว้นว่าง"></div>
            <div><label>แพ้ยา / แพ้อาหาร</label><input type="text" th:field="*{allergy}" placeholder="ไม่มีให้เว้นว่าง"></div>
        </div>

        <div class="btn-r">
            <a th:href="@{/}" class="btn cc">ยกเลิก</a>
            <button type="submit" class="btn sv">
                <i class="fa-solid fa-save"></i> บันทึกข้อมูล
            </button>
        </div>
    </form>
</div>

<script>
    // Theme Management
    const setT = () => {
        const t = document.documentElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
        document.documentElement.setAttribute('data-theme', t);
        localStorage.setItem('theme', t);
    };
    document.documentElement.setAttribute('data-theme', localStorage.getItem('theme') || 'light');

    // Toggle Education Box
    function upd() { 
        const occVal = document.getElementById('occ').value;
        const eduBox = document.getElementById('eduBox');
        if (occVal === 'กำลังศึกษา') {
            eduBox.style.display = 'grid';
        } else {
            eduBox.style.display = 'none';
        }
    }

    // Validation
    function val() { 
        if(/[\d]/.test(document.getElementById('nm').value)){ 
            alert('❌ ชื่อ-นามสกุล ห้ามใส่ตัวเลขครับ!'); 
            return false; 
        } 
        return true; 
    }

    // Run on Load
    window.onload = upd;
</script>
</body>
</html>