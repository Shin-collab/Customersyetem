<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KYC | GSB Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@100;300;400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { 
            --pk: #eb008b; 
            --bg: #f1f5f9;
            --cd: #ffffff;
            --tx: #0f172a;
            --label: #334155;
            --bd: #cbd5e1;
            --in: #ffffff;
            --glass: rgba(255, 255, 255, 0.8);
        }
        
        [data-theme="dark"] { 
            --bg: #040508; 
            --cd: #111827; 
            --tx: #f8fafc; 
            --label: #cbd5e1;
            --bd: #374151; 
            --in: #1f2937;
            --glass: rgba(0, 0, 0, 0.3);
        }

        * { 
            box-sizing: border-box; 
            margin: 0; 
            padding: 0; 
            font-family: 'Sarabun', sans-serif; 
            transition: background 0.2s, color 0.2s, border 0.2s; 
        }
        
        body { 
            background-color: var(--bg);
            background-image: radial-gradient(at 0% 0%, rgba(235, 0, 139, 0.05) 0px, transparent 40%);
            color: var(--tx); 
            padding: 40px 15px; 
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .card { 
            background: var(--cd); 
            max-width: 700px; 
            margin: auto; 
            border-radius: 24px; 
            border: 1px solid var(--bd);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); 
            padding: 40px; 
            position: relative;
            z-index: 10;
        }

        .h-title { 
            font-size: 1.8rem; 
            font-weight: 800; 
            color: var(--pk); 
            text-align: center; 
            margin-bottom: 35px; 
            letter-spacing: 1px;
            text-transform: uppercase;
        }
        
        .grid { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 20px; 
            margin-bottom: 20px; 
        }
        
        .full { grid-column: span 2; }
        
        @media (max-width: 600px) {
            .grid { grid-template-columns: 1fr; gap: 15px; }
            .full { grid-column: span 1; }
            .card { padding: 20px; }
        }
        
        label { 
            font-weight: 600; 
            font-size: 0.95rem; 
            display: block; 
            margin-bottom: 8px; 
            color: var(--label); 
        }
        
        input, select { 
            width: 100%; 
            padding: 12px 16px; 
            border: 2px solid var(--bd); 
            border-radius: 12px; 
            background: var(--in); 
            color: var(--tx); 
            outline: none; 
            font-size: 1rem;
            appearance: none;
            position: relative;
            z-index: 20;
        }
        
        input:focus, select:focus { 
            border-color: var(--pk); 
            box-shadow: 0 0 0 4px rgba(235, 0, 139, 0.15); 
        }
        
        #eduBox { 
            display: none; 
            background: var(--glass); 
            padding: 20px; 
            border-radius: 16px; 
            border: 2px dashed var(--pk); 
            grid-column: span 2; 
            margin-top: 10px;
            z-index: 15;
        }
        
        .btn-r { 
            display: flex; 
            gap: 15px; 
            margin-top: 30px; 
        }
        
        .btn { 
            flex: 1; 
            padding: 16px; 
            border-radius: 12px; 
            font-weight: 700; 
            border: none; 
            cursor: pointer; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            gap: 10px; 
            font-size: 1rem; 
            text-decoration: none;
            position: relative;
            z-index: 30;
        }
        
        .sv { 
            background: var(--pk); 
            color: #ffffff !important; 
            box-shadow: 0 4px 14px 0 rgba(235, 0, 139, 0.39); 
        }
        
        .cc { 
            background: #94a3b8; 
            color: #ffffff !important; 
        }
        
        .btn:hover { 
            transform: translateY(-2px); 
            filter: brightness(1.1); 
        }

        .tgl { 
            position: fixed; 
            top: 20px; 
            right: 20px; 
            cursor: pointer; 
            color: var(--pk); 
            font-size: 1.25rem; 
            z-index: 1000; 
            background: var(--cd); 
            width: 50px; 
            height: 50px; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            border-radius: 50%; 
            border: 2px solid var(--bd);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>

<div class="tgl" onclick="setT()">
    <i class="fa-solid fa-circle-half-stroke"></i>
</div>

<div class="card">
    <div class="h-title">บันทึกข้อมูลลูกค้า (KYC)</div>
    
    <form th:action="@{/customers/save}" th:object="${customer}" method="post" onsubmit="return val()">
        <input type="hidden" th:field="*{id}">
        
        <div class="grid">
            <div class="full">
                <label>ชื่อ-นามสกุล (ภาษาไทย)</label>
                <input type="text" th:field="*{name}" required id="nm" placeholder="ระบุชื่อและนามสกุล" oninput="this.value=this.value.replace(/[0-9]/g,'')">
            </div>
            
            <div>
                <label>ชื่อเล่น</label>
                <input type="text" th:field="*{nickname}" placeholder="ระบุชื่อเล่น">
            </div>
            
            <div>
                <label>วัน/เดือน/ปีเกิด</label>
                <input type="date" th:field="*{birthDate}" required>
            </div>
            
            <div class="full">
                <label>ที่อยู่ปัจจุบัน</label>
                <input type="text" th:field="*{houseNo}" placeholder="เลขที่บ้าน, หมู่บ้าน, ถนน, ตำบล">
            </div>
            
            <div>
                <label>จังหวัด</label>
                <input type="text" th:field="*{province}" placeholder="ระบุจังหวัด">
            </div>
            
            <div>
                <label>อาชีพปัจจุบัน</label>
                <select th:field="*{occupation}" id="occ" onchange="upd()">
                    <option value="พนักงานบริษัท">พนักงานบริษัท</option>
                    <option value="ธุรกิจส่วนตัว">ธุรกิจส่วนตัว/ค้าขาย</option>
                    <option value="ข้าราชการ">ข้าราชการ/รัฐวิสาหกิจ</option>
                    <option value="กำลังศึกษา">นักเรียน/นักศึกษา</option>
                    <option value="รับจ้างทั่วไป">รับจ้างทั่วไป</option>
                    <option value="อื่นๆ">อื่นๆ</option>
                </select>
            </div>
            
            <div id="eduBox">
                <div class="grid" style="margin:0;">
                    <div>
                        <label>ระดับการศึกษา</label>
                        <select th:field="*{education}">
                            <option value="">-- ระบุระดับ --</option>
                            <option value="ประถมศึกษา">ประถมศึกษา</option>
                            <option value="มัธยมศึกษา">มัธยมศึกษา</option>
                            <option value="ปวช./ปวส.">ปวช./ปวส.</option>
                            <option value="ปริญญาตรี">ปริญญาตรี</option>
                            <option value="สูงกว่าปริญญาตรี">สูงกว่าปริญญาตรี</option>
                        </select>
                    </div>
                    <div>
                        <label>ชั้นปี/ระดับชั้น</label>
                        <input type="text" th:field="*{educationYear}" placeholder="เช่น ม.6 หรือ ปี 4">
                    </div>
                    <div class="full">
                        <label>คณะ / สาขาวิชา</label>
                        <input type="text" th:field="*{major}" placeholder="ระบุคณะหรือสายที่เรียน">
                    </div>
                </div>
            </div>
            
            <div class="full">
                <label>สถานที่ทำงาน / ชื่อสถาบันการศึกษา</label>
                <input type="text" th:field="*{workPlace}" placeholder="ระบุชื่อหน่วยงาน">
            </div>
            
            <div>
                <label>โรคประจำตัว</label>
                <input type="text" th:field="*{disease}" placeholder="-">
            </div>
            
            <div>
                <label>ประวัติการแพ้ยา/อาหาร</label>
                <input type="text" th:field="*{allergy}" placeholder="-">
            </div>
        </div>

        <div class="btn-r">
            <a th:href="@{/}" class="btn cc">ยกเลิก</a>
            <button type="submit" class="btn sv">
                <i class="fa-solid fa-save"></i> บันทึกข้อมูลลูกค้า
            </button>
        </div>
    </form>
</div>

<script>
    const setT = () => {
        const html = document.documentElement;
        const current = html.getAttribute('data-theme');
        const next = current === 'dark' ? 'light' : 'dark';
        html.setAttribute('data-theme', next);
        localStorage.setItem('theme', next);
    };
    
    const savedTheme = localStorage.getItem('theme') || 'light';
    document.documentElement.setAttribute('data-theme', savedTheme);

    function upd() { 
        const occVal = document.getElementById('occ').value;
        const eduBox = document.getElementById('eduBox');
        if (occVal === 'กำลังศึกษา') {
            eduBox.style.display = 'grid';
        } else {
            eduBox.style.display = 'none';
        }
    }

    function val() { 
        const nameInput = document.getElementById('nm').value;
        if(/[\d]/.test(nameInput)){ 
            alert('❌ กรุณากรอกชื่อ-นามสกุล เป็นตัวอักษรเท่านั้น'); 
            return false; 
        } 
        return true; 
    }

    window.onload = upd;
</script>
</body>
</html>